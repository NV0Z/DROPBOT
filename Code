--// Nervox Stand Bot
--// Made by kryvendev

--// ========= SERVICES ========= \\--
local Players = game:GetService("Players")
local TextChatService = game:GetService("TextChatService")
local TeleportService = game:GetService("TeleportService")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LP = Players.LocalPlayer

--// ========= CONFIG (from getgenv) ========= \\--
local Config = getgenv().Configuration
local OwnerId = Config.OwnerId
local DropAmount = Config.DropAmount
local DropDelay = Config.DropDelay
local DropPos = Config.DropPos

--// ========= VARIABLES ========= \\--
local Frozen = false
local Dropping = false
local DropConnection
local Whitelist = { [OwnerId] = true }

--// ========= FUNCTIONS ========= \\--
local function sendChat(msg)
    ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(msg, "All")
end

local function teleportAndFreeze()
    LP.Character:PivotTo(CFrame.new(DropPos))
    Frozen = true
    local char = LP.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        char.HumanoidRootPart.Anchored = true
    end
    sendChat("[BOT] Teleported & frozen.")
end

local function unfreeze()
    Frozen = false
    local char = LP.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        char.HumanoidRootPart.Anchored = false
    end
    sendChat("[BOT] Unfrozen.")
end

local function rejoin()
    TeleportService:Teleport(game.PlaceId, LP)
end

local function stopAll()
    if DropConnection then
        DropConnection:Disconnect()
        DropConnection = nil
    end
    Dropping = false
end

local function autoDrop()
    stopAll()
    local args = { "DropMoney", DropAmount }
    Dropping = true

    DropConnection = RunService.Heartbeat:Connect(function()
        ReplicatedStorage:WaitForChild("MainEvent"):FireServer(unpack(args))
        task.wait(DropDelay)
    end)

    sendChat("[BOT] Auto drop started.")
end

--// ========= CHAT LISTENER ========= \\--
TextChatService.OnIncomingMessage = function(message)
    local src = message.TextSource
    if not src then return end
    if src.UserId ~= OwnerId then return end

    local txt = (message.Text or ""):lower()

    if txt == "!startup" then
        teleportAndFreeze()
    elseif txt == "!start" then
        autoDrop()
    elseif txt == "!stop" then
        stopAll()
        unfreeze()
    elseif txt == "!rj" then
        rejoin()
    elseif txt == "cmds!" then
        sendChat("Commands: !startup, !start, !stop, !rj, cmds!")
    end
end

--// ========= AUTO CREDIT LOOP ========= \\--
task.spawn(function()
    while true do
        task.wait(300) -- 5 minutes
        sendChat("Script made by NV0Z")
    end
end)
