--// Nervox Stand Bot
--// Made by kryvendev

--// ========= SERVICES ========= \\--
local Players = game:GetService("Players")
local TextChatService = game:GetService("TextChatService")
local TeleportService = game:GetService("TeleportService")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LP = Players.LocalPlayer

--// ========= CONFIG (from getgenv) ========= \\--
local Config = getgenv().Configuration
local OwnerId = Config.OwnerId
local DropAmount = Config.DropAmount
local DropDelay = Config.DropDelay
local DropPos = Config.DropPos

--// ========= VARIABLES ========= \\--
local Frozen = false
local Dropping = false
local DropConnection
local Whitelist = { [OwnerId] = true }

--// ========= UI ========= \\--
local ScreenGui = Instance.new("ScreenGui", LP.PlayerGui)
local ChatFrame = Instance.new("Frame", ScreenGui)
ChatFrame.Size = UDim2.new(0, 300, 0, 200)
ChatFrame.Position = UDim2.new(0, 10, 0.7, 0)
ChatFrame.BackgroundTransparency = 0.3
ChatFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)

local ChatBox = Instance.new("ScrollingFrame", ChatFrame)
ChatBox.Size = UDim2.new(1, 0, 1, 0)
ChatBox.CanvasSize = UDim2.new(0, 0, 0, 0)
ChatBox.AutomaticCanvasSize = Enum.AutomaticSize.Y
ChatBox.ScrollBarThickness = 4

--// ========= FUNCTIONS ========= \\--
local function addChatLine(text, highlight)
    local Label = Instance.new("TextLabel", ChatBox)
    Label.Size = UDim2.new(1, -5, 0, 18)
    Label.BackgroundTransparency = 1
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Font = Enum.Font.Code
    Label.TextSize = 14
    Label.Text = text
    Label.TextColor3 = highlight and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 255, 255)
end

local function sendChat(msg)
    ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(msg, "All")
end

local function teleportAndFreeze()
    LP.Character:PivotTo(CFrame.new(DropPos))
    Frozen = true
    local char = LP.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        char.HumanoidRootPart.Anchored = true
    end
    sendChat("[BOT] Teleported & frozen.")
end

local function unfreeze()
    Frozen = false
    local char = LP.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        char.HumanoidRootPart.Anchored = false
    end
    sendChat("[BOT] Unfrozen.")
end

local function rejoin()
    TeleportService:Teleport(game.PlaceId, LP)
end

local function stopAll()
    if DropConnection then
        DropConnection:Disconnect()
        DropConnection = nil
    end
    Dropping = false
end

--// ========= DROP LOOP ========= \\--
local function autoDrop()
    stopAll()
    local args = { "DropMoney", DropAmount }
    Dropping = true

    DropConnection = RunService.Heartbeat:Connect(function()
        ReplicatedStorage:WaitForChild("MainEvent"):FireServer(unpack(args))
        task.wait(DropDelay)
    end)

    sendChat("[BOT] Auto drop started.")
end

--// ========= CHAT LISTENER ========= \\--
TextChatService.OnIncomingMessage = function(message)
    local src = message.TextSource
    local sender = src and Players:GetPlayerByUserId(src.UserId)
    local msgText = message.Text or ""

    if sender then addChatLine(sender.Name .. ": " .. msgText, src.UserId == OwnerId)
    else addChatLine("[System]: " .. msgText, false) end

    if not src then return end
    local isOwner = src.UserId == OwnerId
    if not isOwner then return end

    local txt = msgText:lower()

    if txt == "!startup" then
        teleportAndFreeze()
    elseif txt == "!start" then
        autoDrop()
    elseif txt == "!stop" then
        stopAll()
        unfreeze()
    elseif txt == "!rj" then
        rejoin()
    elseif txt == "cmds!" then
        sendChat("Commands: !startup, !start, !stop, !rj, cmds!")
    end
end

--// ========= AUTO CREDIT LOOP ========= \\--
task.spawn(function()
    while true do
        task.wait(300) -- 5 minutes
        sendChat("Script made by NV0Z")
    end
end)
